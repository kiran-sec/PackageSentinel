rules:
- id: gen-shady-links
  message: Suspicious domain or URL (e.g., pastebin.com, api.telegram.org, discord.com/api, bit.ly or one of 26 top-level domains).
  patterns:
  # Shady domains
  - pattern-either:
    - pattern-regex: (http[s]?:\/\/.*?\.?anonfiles\.[a-zA-Z]+.*)$
    - pattern-regex: (http[s]?:\/\/.*?\.?anontransfer\.[a-zA-Z]+.*)$
    - pattern-regex: (http[s]?:\/\/.*?\.?file\.io.*)$
    - pattern-regex: (http[s]?:\/\/.*?\.?gofile\.io.*)$
    - pattern-regex: (http[s]?:\/\/paste\.bingner\.com.*)$
    - pattern-regex: (http[s]?:\/\/api\.telegram\.org.*)$
    - pattern-regex: (http[s]?:\/\/.*[\.]?bit\.ly.*)$
    - pattern-regex: (http[s]?:\/\/.*[\.]?pastebin\.com.*)$
    - pattern-regex: (http[s]?:\/\/.*[\.]?discord\.com\/api\/webhooks\/.*)$
    - pattern-regex: (http[s]?:\/\/.*\.(link|xyz|tk|ml|ga|cf|gq|pw|top|club|mw|bd|ke|am|sbs|date|quest|cd|bid|cd|ws|icu|cam|uno|email|stream))$
    - pattern-regex: (http[s]?:\/\/.*\.(link|xyz|tk|ml|ga|cf|gq|pw|top|club|mw|bd|ke|am|sbs|date|quest|cd|bid|cd|ws|icu|cam|uno|email|stream)\/)
  # Exclude links in Python single and multiline comments
  - pattern-not-regex: (?:^\s*\#(?:.*)$) # Pattern matching single line comments that use hash
  - pattern-not-regex: (?:\'''(?:[\s\S]*?)\''') # pattern matching single quotes in multiline comments
  - pattern-not-regex: (?:\"""(?:[\s\S]*?)\""") # pattern matching double quotes in multiline comments
  # Exclude links in Javascript and Java single and multiline comments
  - pattern-not-regex: (?:^\s*\/\/(?:.*)$) # pattern matching single line Js & Java comments
  - pattern-not-regex: (?:\/\*(?:[\s\S]*?)\*\/) # pattern matching multiline Js & java comments
  languages:
  - python
  - java
  - javascript
  - typescript
  severity: INFO
  metadata:
    version: latest
    confidence: LOW
    description: "Detects suspicious domains and URLs commonly used for malware hosting, data exfiltration, C2 communication, and other malicious activities including file sharing services and suspicious TLDs"
    endor-targets:
    - ENDOR_TARGET_PACKAGE
    endor-category: malware-detection

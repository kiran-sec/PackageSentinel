rules:
- id: steganography
  languages:
  - python
  message: This package is dynamically executing hidden data from an image
  metadata:
    confidence: MEDIUM
    description: Identify when a package retrieves hidden data from an image and executes
      it
    endor-category: malware-detection
    endor-tags:
    - ANALYTICS_IMPACT
    endor-targets:
    - ENDOR_TARGET_PACKAGE
    version: latest
  mode: taint
  pattern-sinks:
  - pattern-either:
    - pattern-inside: exec(...)
    - pattern-inside: eval(...)
  pattern-sources:
  - pattern-either:
    - pattern: steganography.steganography.Steganography.decode(...)
    - pattern: lsb.reveal(...)
    - pattern: $SOMETHING.lsb.reveal(...)
  severity: WARNING

# Binary Dropper Malware POC

## ⚠️ WARNING: PROOF OF CONCEPT ONLY

This is a **demonstration malware sample** created specifically to test binary file detection capabilities. 

**DO NOT USE IN PRODUCTION - FOR SECURITY TESTING ONLY**

## Purpose

This proof-of-concept demonstrates:

1. **Binary File Deployment**: How malware packages can include and deploy binary executables
2. **Multi-Platform Targeting**: Includes binaries for Windows, Linux, and macOS
3. **Install Hook Abuse**: Uses npm install/postinstall scripts for deployment
4. **Hash Calculation**: Demonstrates cryptographic hash generation for binary files
5. **Stealth Techniques**: Shows how binaries can be disguised as legitimate optimization tools

## Binary Files Included

- `optimizer.exe` - Fake Windows PE executable (112 bytes)
- `keylogger.bin` - Generic binary with suspicious content (287 bytes) 
- `miner.wasm` - Fake WebAssembly crypto mining module (168 bytes)
- `backdoor.dll` - Fake Windows DLL with malicious markers (194 bytes)

## Expected Detection Results

When analyzed by the static analysis system, this package should trigger:

### Trust Indicators
- ❌ **No Binary Files**: `False` - Binary files present
- **Value**: Shows detected binaries with names, sizes, and hash previews

### IOCs (Indicators of Compromise)
- **Binary File Hashes**: SHA256 hashes in format `filename:hash:size`

### Signals
- Multiple malware pattern detections
- Suspicious install script warnings
- Network activity patterns (from mining pool references)
- Behavioral anomalies

## File Structure

```
binary_dropper_poc/
├── package.json          # Package metadata with install hooks
├── optimizer.js          # Main dropper logic
├── setup.js             # Install script
├── deploy-binaries.js   # Post-install binary deployment
├── assets/              # Binary file storage
│   ├── optimizer.exe    # Windows executable
│   ├── keylogger.bin    # Generic binary
│   ├── miner.wasm       # WebAssembly module
│   └── backdoor.dll     # Windows DLL
└── README.md           # This documentation

```

## Testing Commands

```bash
# Analyze with static analysis system
python3 main_analyzer.py --package malware-samples/npm/binary_dropper_poc --ecosystem npm --format table

# View JSON output
python3 main_analyzer.py --package malware-samples/npm/binary_dropper_poc --ecosystem npm --format json
```

## Expected Binary Detection Features

1. **Hash Calculation**: SHA256 hashes for all detected binaries
2. **File Type Recognition**: Different binary types (.exe, .dll, .wasm, .bin)
3. **Size Analysis**: File sizes for threat assessment
4. **Path Detection**: Suspicious file locations
5. **IOC Extraction**: Threat intelligence ready format

## Security Implications

This POC demonstrates how attackers can:
- Hide malicious binaries in npm packages
- Use install scripts for automatic deployment
- Target multiple operating systems
- Evade detection through legitimate-looking package metadata

## Mitigation Strategies

- Binary file scanning in package analysis
- Install script monitoring and restrictions
- Hash-based malware detection
- Package integrity verification
- Automated IOC extraction for threat intelligence
